<h1>Real Time Products</h1>
  <ul id="productList">
    {{#each products}}
      <li>{{this.title}} - {{this.price}}</li>
    {{/each}}
  </ul>
  
  <form id="addProductForm">
    <label for="title">Title:</label>
    <input type="text" id="title" name="title">
    <label for="price">Price:</label>
    <input type="number" id="price" name="price">
    <button type="submit">Add Product</button>
  </form>

  <form id="deleteProductForm">
    <label for="id">Product ID:</label>
    <input type="text" id="id" name="id">
    <button type="submit">Delete Product</button>
  </form>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const productList = document.getElementById('productList');
    const addProductForm = document.getElementById('addProductForm');
    const deleteProductForm = document.getElementById('deleteProductForm');

    // Add product to list when received from server
    socket.on('productAdded', (product) => {
      const li = document.createElement('li');
      li.innerText = `${product.title} - ${product.price}`;
      productList.appendChild(li);
    });

    // Remove product from list when received from server
    socket.on('productDeleted', (productId) => {
      const li = document.getElementById(`product-${productId}`);
      if (li) {
        li.remove();
      }
    });

    // Send new product to server when form submitted
    addProductForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const titleInput = document.getElementById('title');
      const priceInput = document.getElementById('price');
      const title = titleInput.value.trim();
      const price = parseInt(priceInput.value);
      if (!title || isNaN(price)) {
        return;
      }
      socket.emit('addProduct', { name, price });
      nameInput.value = '';
      priceInput.value = '';
    });

    // Send product ID to server when form submitted
    deleteProductForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const idInput = document.getElementById('id');
      const id = idInput.value.trim();
      if (!id) {
        return;
      }
      socket.emit('deleteProduct', id);
      idInput.value = '';
    });
  </script>